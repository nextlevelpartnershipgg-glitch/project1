# TG News FreeBot (Zero-API-cost)

Готовый Telegram-бот, публикующий новости на русском в официально‑научном стиле **без платных API**.
- Источники: публичные RSS.
- Тексты: локальная LLM через **Ollama** (`llama3.1:8b-instruct-q4_K_M` по умолчанию).
- Обложки: Pillow (строгий новостной стиль, сетка + трендовая линия + заголовок).
- Планировщик: APScheduler.
- Публикация: в один указанный чат/канал (`TARGET_CHAT_ID`).

## Быстрый старт

### 1) Создайте бота и права публикации
- Получите токен у **@BotFather** (`TG_TOKEN`).
- Добавьте бота в канал/группу и назначьте **админом** (право публиковать).
- Узнайте `TARGET_CHAT_ID`. Проще всего — напишите боту в личку `/start`: он пришлёт ваш chat_id. Для канала используйте формат `-100xxxxxxxxxx` (видно в пересылке/через ботов-помощников).

### 2) Подготовьте `.env`
Скопируйте `.env.example` → `.env` и заполните:
```
TG_TOKEN=123456:ABC...            # токен бота
TARGET_CHAT_ID=-1001234567890     # id канала/чата для публикаций
NEWS_INTERVAL_MIN=30              # как часто проверять RSS (в минутах)
TZ=Europe/Moscow                  # часовой пояс планировщика
OLLAMA_URL=http://ollama:11434    # адрес локального Ollama
LLM_MODEL=llama3.1:8b-instruct-q4_K_M
```

### 3) Запуск в Docker
Установите Docker и выполните в корне проекта:
```
docker compose up -d
```
Первый запуск подгрузит модель в контейнере `ollama`. После этого бот запустится автоматически.

### 4) Проверьте команды
- `/start` — проверка и справка (в личке также покажет ваш chat_id).
- `/post <тезис>` — сделать разовый пост (заголовок + тезисы + обложка).
- `/news_on` — включить автоленту по RSS.
- `/news_off` — выключить автоленту.
- `/status` — статус расписания и список RSS.

### 5) Настройте источники
Откройте `app/config.py` — список `RSS_FEEDS`. Добавляйте свои RSS (публичные/legal).

---

## Что внутри
- `docker-compose.yml` — сервисы `bot` и `ollama`.
- `Dockerfile` — окружение Python 3.11 + зависимости.
- `app/main.py` — точка входа, команды, планировщик.
- `app/services/` — RSS, LLM, генерация обложек, пайплайн.
- `assets/fonts/` — используется системный DejaVuSans из образа (пакет `fonts-dejavu-core`).

## Ограничения и рекомендации
- Локальная модель 7–8B: держим стиль кратким, фактическим. Модель пишет **только** из поданных выдержек.
- Обложки — абстрактные (схематичный график/стрелки), не фото события.
- Для каналов — убедитесь, что у бота есть права публикации.

## Лицензия
MIT
